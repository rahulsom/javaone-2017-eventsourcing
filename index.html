<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="author" content="Rahul Somasunderam" /><title>Event Sourcing with JVM Languages</title><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport" /><link href="reveal.js/css/reveal.css" rel="stylesheet" /><link rel="stylesheet" href="reveal.js/css/theme/custom.css" id="theme" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" /><script type="text/x-mathjax-config">MathJax.Hub.Config({
tex2jax: {
  inlineMath: [["\\(", "\\)"]],
  displayMath: [["\\[", "\\]"]],
  ignoreClass: "nostem|nolatexmath"
},
asciimath2jax: {
  delimiters: [["\\$", "\\$"]],
  ignoreClass: "nostem|noasciimath"
},
TeX: { equationNumbers: { autoNumber: "none" } }
});</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.4.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet" /><script>document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );</script><script src="https://code.jquery.com/jquery-2.2.4.min.js" ></script></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title"><h1>Event Sourcing with JVM Languages</h1><div class="preamble"><aside class="notes"><div class="paragraph"><p>Good afternoon everyone! My name is Rahul.
This talk is about Event Sourcing, JVM Languages and how they play with each other.
If you have a question, feel free to grab my attention; I&#8217;ll do my best to answer it right away.</p></div></aside>
<div class="openblock footer"><div class="content"><div class="paragraph"><p>JavaOne 2017</p></div></div></div></div><p class="author"><small>Rahul Somasunderam</small></p></section>
<section id="slide-about-me"><h2>About Me</h2><div class="ulist step"><ul><li class="fragment"><p>Wanted Event Sourcing in 2016</p></li><li class="fragment"><p>Didn&#8217;t like anything I saw</p></li><li class="fragment"><p>Built my own thing - Grooves</p></li><li class="fragment"><p>I solve problems in Health Care</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>Until mid 2015, I had never heard of the term event sourcing.
I learnt about it at a conference talk in Minneapolis, and the idea captivated my mind since then.</p></div>
<div class="paragraph"><p>In early 2016, I was given a problem to solve, and after digging around, I felt that this would be a great place to use event sourcing.
So I started looking for libraries and frameworks that solved that problem.
Unfortunately, nothing worked for my specific problems.</p></div>
<div class="paragraph"><p>So I did the next best thing - I wrote my own solution.
This talk will use that in examples, but most ideas are transferrable to other libraries.</p></div>
<div class="paragraph"><p>Also, I work in Health Care.
That probably explains #2 on the list.</p></div></aside></section>
<section id="slide-where-i-work"><h2>Where I work</h2><div class="imageblock" style=""><img src="./images/BoxCutter.png" alt="BoxCutter" height="300em" /></div>
<div class="paragraph small"><small>Transcend Insights® empowers population health management with The Platform Above—technology that rises above the data silos and connects care teams with the insights they need to succeed in a value-based care world.</small></div>
<aside class="notes"><div class="paragraph"><p>I work for a company called Transcend Insights.
We traditionally dealt with <em>Health Information Exchange</em> and <em>Health data analytics</em>.</p></div>
<div class="paragraph"><p>We wanted to get into data warehousing and reporting.
That&#8217;s where we ended up using event sourcing.</p></div>
<div class="paragraph"><p>Our raw data is very different from IOT, Banking, and Retail.
They have thousands of events a second, with payloads typically in a few kilobytes.
We have tens of events a second, at best, and ridiculously large payloads.
100s of kb to 10s of Mb is fairly common.
Occasionally we go up to a few Gb of data.</p></div></aside></section>
<section id="slide-about-you" class="to-top"><h2>About You</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:25%" /><col style="width:25%" /><col style="width:25%" /><col style="width:25%" /></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="imageblock fragment" style=""><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5d/Duke_%28Java_mascot%29_waving.svg/568px-Duke_%28Java_mascot%29_waving.svg.png" alt="568px Duke %28Java mascot%29 waving.svg" height="200em" /></div></div></td><td class="tableblock halign-left valign-top"><div><div class="imageblock fragment" style=""><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/Groovy-logo.svg/1200px-Groovy-logo.svg.png" alt="1200px Groovy logo.svg" height="200em" /></div></div></td><td class="tableblock halign-left valign-top"><div><div class="imageblock fragment" style=""><img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/Kotlin-logo.png" alt="Kotlin logo" height="200em" /></div></div></td><td class="tableblock halign-left valign-top"><div><div class="imageblock fragment" style=""><img src="https://cdn1.iconfinder.com/data/icons/smoothline-action/30/action_042-detail-more-info-others-512.png" alt="action 042 detail more info others 512" height="200em" /></div></div></td></tr></tbody></table>
<aside class="notes"><div class="paragraph"><p>Let&#8217;s do a show of hands.</p></div>
<div class="paragraph"><p>How many of you use Java as your primary language for writing code?</p></div>
<div class="paragraph"><p>Groovy?</p></div>
<div class="paragraph"><p>Kotlin?</p></div>
<div class="paragraph"><p>Others?</p></div>
<div class="paragraph"><p>My examples are targeted towards Java, Groovy and Kotlin, but if it works with these languages, it should work with most languages.</p></div></aside></section>
<section><section id="slide-what-is-event-sourcing"><h2>What is Event Sourcing</h2><div class="quoteblock"><blockquote><div class="paragraph"><p>Treat your database like you treat your application logs</p></div></blockquote></div><aside class="notes"><div class="paragraph"><p>Almost everyone produces application logs.
Most of us debug other people&#8217;s applications using logs.
Some of us audit the application using application logs.</p></div></aside></section><section id="slide-what-does-that-mean"><h2>What does that mean</h2><div class="paragraph"><p>Create</p></div>
<div class="paragraph"><p>Read</p></div>
<div class="paragraph"><p><span class="line-through">Update</span></p></div>
<div class="paragraph"><p><span class="line-through">Delete</span></p></div>
<aside class="notes"><div class="paragraph"><p>I think this was spotted early on in Jonas Bonér&#8217;s slide decks.
It beautifully represents what we need to be doing.
Sometimes you&#8217;ll have legal requirements to remove data, i.e. offer consumers a right to be forgotten.</p></div></aside></section></section>
<section><section id="slide-bad-example-1" data-background-image="./images/redbg.jpg"><h2>Bad Example 1</h2><div class="paragraph"><p>Mark and Jane share a bank account.
The account has a balance of $75.
Mark goes to an ATM and withdraws $50.
At the same time Jane attempts to withdraw $50.</p></div><div class="paragraph"><p>This is what our code looks like</p></div><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">@Transactional
boolean withdraw(String accountNumber, double amount) {
  double balance = accountService.getBalance(accountNumber);
  if (balance &gt; amount) {
    balance -= account;
    accountService.setBalance(accountNumber, balance);
    return true;
  } else {
    return false;
  }
}</code></pre></div></div><script>$('#slide-bad-example-1 pre').attr('data-line', '1');</script><aside class="notes"><div class="paragraph"><p>A lot of text books and tutorials teach transaction management this way.
Adding <code>@Transactional</code> is what they recommend.
Actually, they teach you to start and stop transactions manually.
I would have done that, but then it wouldn&#8217;t fit on a slide.</p></div>
<div class="paragraph"><p>However, this is not how banks deal with transactions.
And they&#8217;ve been dealing with transactions since before computers were a thing.</p></div>
<div class="paragraph"><p>Also I&#8217;m using <code>double</code> for <code>amount</code> instead of using <code>BigDecimal</code>.
This is also to make the slide concise.</p></div></aside></section><section id="slide-what-banks-typically-do"><h2>What banks typically do</h2><div class="imageblock" style=""><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Sparbuch_der_Deutschen_Bundespost_1986%2C_Doppelseite.jpg/2560px-Sparbuch_der_Deutschen_Bundespost_1986%2C_Doppelseite.jpg" alt="2560px Sparbuch der Deutschen Bundespost 1986%2C Doppelseite" /></div>
<div class="openblock highlighted attribution"><div class="content"><div class="paragraph"><p>By Deutsche Bundespost (Scan by User:Mattes) - Scan (700dpi, Millionen Farben), Public Domain
<a href="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Sparbuch_der_Deutschen_Bundespost_1986%2C_Doppelseite.jpg/2560px-Sparbuch_der_Deutschen_Bundespost_1986%2C_Doppelseite.jpg">Wikimedia</a></p></div></div></div>
<aside class="notes"><div class="paragraph"><p>This is what banks typically do.
I could only find an example in German, but if you&#8217;re old enough, you&#8217;ve seen one.
If not, welcome to the 80&#8217;s.
And this is not new, it&#8217;s something banks have done for 100s of years.</p></div>
<div class="paragraph"><p>The columns we see there are</p></div>
<div class="ulist"><ul><li><p>timestamp</p></li><li><p>description</p></li><li><p>credit</p></li><li><p>debit</p></li><li><p>balance</p></li><li><p>authorization</p></li></ul></div>
<div class="paragraph"><p>This is beautiful.</p></div>
<div class="paragraph"><p>You can always look at the last line with balance and know how much money you have before writing a check.
And if you think the transactions don&#8217;t add up, you can manually check that they&#8217;ve done calculations correctly.</p></div></aside></section><section id="slide-but-that-was-em-banking-em"><h2>But that was <em>Banking</em></h2><div class="paragraph fragment"><p>If you can look at your logs and debug your application, you are already doing that.</p></div>
<div class="paragraph fragment"><p>Banks defined their business model this way hundreds of years ago.</p></div>
<aside class="notes"><div class="paragraph"><p>If you are looking at application logs to confirm or deny that there is a bug, you are actually a human that&#8217;s performing event sourcing on your logs.
I&#8217;ve done that. Several times.</p></div>
<div class="paragraph"><p>Banks have trained you to debug their logs.
It&#8217;s pure genius.
Getting the customer who has no access to source code, to debug the application&#8230;&#8203;</p></div>
<div class="paragraph"><p>If banks can do that, you can do that.
It could be a little harder, but not impossible.
But if you succeed at doing that, the benefits are huge.</p></div></aside></section><section id="slide-what-about-my-domain"><h2>What about my domain?</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%" /><col style="width:33.3333%" /><col style="width:33.3334%" /></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">/* Aggregate */
class Account {
  String accountNumber;
}</code></pre></div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">/* Events */
abstract class Transaction {
  Account account;
}
class AtmWithdrawal
    extends Transaction {
  String location;
  double amount;
}
class AtmDeposit
    extends Transaction {
  String location;
  double amount;
}</code></pre></div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">/* Snapshot */
class AccountSummary {
  double balance;
}</code></pre></div></div></div></td></tr></tbody></table>
<aside class="notes"><div class="paragraph"><p>So this is what a bank does.
You can clearly split this into 3 types of domain classes.
And if you try to do something similar to your domain, you can get a similar domain model too.</p></div></aside></section><section id="slide-what-about-my-domain-2"><h2>What about my domain?</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%" /><col style="width:33.3333%" /><col style="width:33.3334%" /></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">/* Aggregate */
class Patient {
  String identifier;
  String system;
}</code></pre></div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">/* Events */
abstract class PatientEvent {
  Patient patient;
}
class MedicationPrescribed
    extends PatientEvent {
  String code;
  int quantity;
}
class ProcedurePerformed
    extends PatientEvent {
  String code;
}</code></pre></div></div></div></td><td class="tableblock halign-left valign-top"><div><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">/* Snapshot */
class PatientSummary {
  List&lt;String&gt; medications;
  List&lt;String&gt; procedures;
}</code></pre></div></div></div></td></tr></tbody></table>
<aside class="notes"><div class="paragraph"><p>Here, I&#8217;ve replaced all banking related models with some Health Care related models.</p></div></aside></section><section id="slide-computing-snapshots"><h2>Computing Snapshots</h2><div class="stemblock"><div class="content">\$S_N = f(S_0 , E_1..E_N)\$</div></div>
<table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:20%" /><col style="width:80%" /></colgroup><tbody><tr><td class="tableblock halign-right valign-top"><div><div class="paragraph"><p>\$S_N\$</p></div></div></td><td class="tableblock halign-left valign-top"><p class="tableblock">Snapshot at Version N</p></td></tr><tr><td class="tableblock halign-right valign-top"><div><div class="paragraph"><p>\$S_0\$</p></div></div></td><td class="tableblock halign-left valign-top"><p class="tableblock">empty snapshot</p></td></tr><tr><td class="tableblock halign-right valign-top"><div><div class="paragraph"><p>\$E_1..E_N\$</p></div></div></td><td class="tableblock halign-left valign-top"><p class="tableblock">events from position 1 through N</p></td></tr><tr><td class="tableblock halign-right valign-top"><div><div class="paragraph"><p>\$f\$</p></div></div></td><td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td></tr></tbody></table>
<aside class="notes"><div class="paragraph"><p>Here&#8217;s the mathematics that needs to work correctly for Event Sourcing to work.</p></div>
<div class="paragraph"><p>Let&#8217;s assume the N-th version of the snapshot is what we want to compute.</p></div>
<div class="paragraph"><p>The empty snapshot in banking is a zero balance account.
In our health care example, it would be a patient with no medications and no procedures.</p></div>
<div class="paragraph"><p>We will be applying each event from position 1 through N, one at a time.
For each event, given the <em>before</em> state of the snapshot, you should be able to compute the <em>after</em> state.</p></div>
<div class="paragraph"><p>That computation is what we call the <em>query</em>.</p></div></aside></section></section>
<section><section id="slide-but-it-s-not-that-simple" data-background-image="./images/redbg.jpg"><h2>But it&#8217;s not that simple</h2><aside class="notes"><div class="paragraph"><p>If you&#8217;ve seen a business checking account, you&#8217;ll know that it&#8217;s possible to have hundreds of transactions in a day.
It&#8217;s not feasible to keep computing the balance everytime you need to know the snapshot at version N.</p></div></aside></section><section id="slide-incremental-computation"><h2>Incremental Computation</h2><div class="paragraph"><p>This is what we would like to do</p></div>
<div class="stemblock"><div class="content">\$S_N = f(S_K , E_(K+1)..E_N)\$</div></div>
<div class="paragraph"><p>In Mathematics, it&#8217;s called the distributive property</p></div>
<div class="stemblock"><div class="content">\$a+b+c = (a+b) +c\$</div></div>
<aside class="notes"><div class="paragraph"><p>If we&#8217;ve got a partial computation and we can persist it, we would like to reuse it.
In Mathematics, it&#8217;s called the distributive property.</p></div></aside></section><section id="slide-we-re-not-done-yet" data-background-image="./images/redbg.jpg"><h2>We&#8217;re not done yet</h2><div class="paragraph"><p>There are special events</p></div></section><section id="slide-revert"><h2>Revert</h2><div class="imageblock" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/RevertEvent.svg" alt="RevertEvent" /></div>
<div class="imageblock fragment" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/RevertEventEffective.svg" alt="RevertEventEffective" /></div>
<aside class="notes"><div class="paragraph"><p>Mistakes happen.
All the time.
Users might fat finger something on your UI.
Or another application might have a bug.
Or you might allow reversal of charges as a business policy.</p></div>
<div class="paragraph"><p>Regardless of why you do this, you&#8217;ll want to support reverts.
In this example, we have events 1-4.
Then someone realizes that 3 was a mistake.
You never want to remove 3.
So what you do is, you create 5 that says, "forget 3 ever happened".
When computing snapshots the system will behave as if 3 never happened.
However when auditing the system, it will behave as if 3 and 5 both happened.
There isn&#8217;t much value to this when only looking at balances in a bank account.
However, this can change a whole lot of things when dealing with more complex domains.</p></div></aside></section><section id="slide-revert-again"><h2>Revert Again</h2><div class="imageblock" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/RevertOnRevert.svg" alt="RevertOnRevert" /></div>
<div class="imageblock fragment" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/RevertOnRevertEffective.svg" alt="RevertOnRevertEffective" /></div>
<aside class="notes"><div class="paragraph"><p>Any event in your system can be reverted.
This means that a revert event can also be reverted.</p></div>
<div class="paragraph"><p>In this example, 6 reverts 5.
That means 5 cannot revert 3 anymore.</p></div>
<div class="paragraph"><p>Reverts actually are applied in reverse order.
That makes things like this possible.</p></div></aside></section><section id="slide-merge-deprecate"><h2>Merge/Deprecate</h2><div class="imageblock" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/MergeAggregates.svg" alt="MergeAggregates" /></div>
<div class="imageblock fragment" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/MergeAggregatesEffective.svg" alt="MergeAggregatesEffective" /></div>
<aside class="notes"><div class="paragraph"><p>In some domains, it&#8217;s uncommon to create a new aggregate in a hurry.
In Health care, for example, it is extremely common.
It&#8217;s more important to provide health care than it is to find the right record and keep your database clean.</p></div>
<div class="paragraph"><p>So in our example now we have 2 aggregates that actually represent the same patient.
Once we realize that it&#8217;s the same person, we need to convince the system to sort out the timeline and remove the duplicate.</p></div>
<div class="paragraph"><p>6 tells you that Freddie is deprecated by the long standing record of Farrokh.
7 tells you that when computing Farrokh&#8217;s snapshot, you should pay attention to events in Freddie&#8217;s timeline as well.</p></div></aside></section><section id="slide-reverting-a-merge"><h2>Reverting a Merge</h2><div class="imageblock" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/RevertMergeBefore.svg" alt="RevertMergeBefore" /></div>
<div class="imageblock fragment" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/RevertMergeAfter.svg" alt="RevertMergeAfter" /></div>
<aside class="notes"><div class="paragraph"><p>Oh, and these events can be merged too.
You want to be careful enough to revert both events at the same time.</p></div></aside></section></section>
<section><section id="slide-bad-example-2" data-background-image="./images/redbg.jpg"><h2>Bad Example 2</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Employee</p></div>
<table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%" /><col style="width:33.3333%" /><col style="width:33.3334%" /></colgroup><thead><tr><th class="tableblock halign-right valign-top">ID</th><th class="tableblock halign-left valign-top">EMP_NAME</th><th class="tableblock halign-right valign-top">DEPT_ID</th></tr></thead><tbody><tr><td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Mr Spock</p></td><td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Scotty</p></td><td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Kirk</p></td><td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Janeway</p></td><td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">La Forge</p></td><td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td></tr></tbody></table></div></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Department</p></div>
<table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead><tr><th class="tableblock halign-right valign-top">ID</th><th class="tableblock halign-left valign-top">DEPT_NAME</th></tr></thead><tbody><tr><td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Science</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Engineering</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Command</p></td></tr></tbody></table></div></td></tr></tbody></table><aside class="notes"><div class="paragraph"><p>Here&#8217;s another textbook example that I think is bad.
Here&#8217;s your favorite star trek characters and their departments shown in our tables.
We are using a foreign key to point us to the right department.</p></div>
<div class="paragraph"><p>This does not always work correctly.
Let&#8217;s look how we would solve this in an event sourced system for a simple case first.</p></div></aside></section><section id="slide-joins-in-event-sourcing"><h2>Joins in Event Sourcing</h2><div class="imageblock" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/JoinExample.svg" alt="JoinExample" /></div>
<aside class="notes"><div class="paragraph"><p>Scotty is more of a one trick pony.
So all we need is an event in Scotty&#8217;s timeline that tells us he&#8217;s now in Engineering.
And another in Engineering&#8217;s timeline that tells Scotty has joined.</p></div>
<div class="paragraph"><p>Nothing magical about this.</p></div></aside></section><section id="slide-disjoins-too"><h2>Disjoins too</h2><div class="imageblock" style=""><img src="https://rahulsom.github.io/grooves/manual/0.2.0/DisjoinExample.svg" alt="DisjoinExample" /></div>
<aside class="notes"><div class="paragraph"><p>Mr Spock on the other hand, is very special.
He started off as a Science officer.
Then he became Captain.
In one episode, he was an admiral.
The Star Trek wiki tells me he&#8217;s now Federation Ambassador.</p></div>
<div class="paragraph"><p>When he moved from Science to Command, our textbook example would stop working.
We need to preserve this information in a usable way.</p></div></aside></section></section>
<section><section id="slide-grooves-domain-objects"><h2>Grooves Domain Objects</h2></section><section id="slide-aggregates"><h2>Aggregates</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">public class Patient implements AggregateType&lt;Long&gt; {
    private Long id;
    private String uniqueId;
}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>This assumes your natural id is separate from your primary key.</p></div>
<div class="paragraph"><p>If you don&#8217;t need a separate natural id, good for you.
All you need then is the <code>id</code>.</p></div>
<div class="paragraph"><p>The type of <code>id</code> goes into the generic type param of <code>AggregateType</code>.</p></div></aside></section><section id="slide-events"><h2>Events</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">public abstract class PatientEvent implements
        BaseEvent&lt;Long, Patient, Long, PatientEvent&gt; {
    private Patient aggregate;
    private Long id;
    private String createdBy;
    private RevertEvent&lt;Long, Patient, Long, PatientEvent&gt; revertedBy;
    private Date timestamp;
    private Long position;

    @Override
    @NotNull
    public Observable&lt;Patient&gt; getAggregateObservable() {
        return aggregate != null ? just(aggregate) : empty();
    }
}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>This is a base class for all events that we&#8217;ll be applying on <code>Patient</code>.
All these properties are required to make Grooves happy.</p></div>
<div class="paragraph"><p><code>createdBy</code> is where we&#8217;ll put in some information on the authorization.</p></div>
<div class="paragraph"><p><code>revertedBy</code> is going to be transient from a database perspective.
That will allow us to build an audit ui that tells us why a certain event was reverted.
It will point to a Revert Event.</p></div>
<div class="paragraph"><p><code>timestamp</code> and <code>position</code> are going to help us work with a timeline.
Sometimes we need to look at the time of an event.
Sometimes we just care about the position of an event.</p></div>
<div class="paragraph"><p>The position is interesting, in that it could be global, or it could be specific to an aggregate.</p></div>
<div class="paragraph"><p>If you make it global, you can answer questions about the state of the whole system.
That works a bit like SVN used to work for versioning code.</p></div>
<div class="paragraph"><p>If you make it local, then it works more locally, but it can then be used for optimistic locking.
You can try to do optimistic locking with global positioning, but the effects on scalability might not be good.</p></div>
<div class="paragraph"><p>You&#8217;ll notice that the type params are already getting long, and they will continue to get longer as we work on queries.
So I&#8217;ll skip type parameters occasionally here.
If you end up using grooves, the documentation will guide you on them.</p></div></aside></section><section id="slide-real-events"><h2>Real Events</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">public class PatientCreated extends PatientEvent {
    private String name;
}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>This is our first real event.
All this does for us is let us set the name for the patient at the time of creation.</p></div></aside></section><section id="slide-special-events"><h2>Special Events</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">public class PatientEventReverted
        extends PatientEvent
        implements RevertEvent&lt;Long, Patient, Long, PatientEvent&gt; {
    private Long revertedEventId;
}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>At some point you will want to support the special events.
We&#8217;ll take revert as an example.
Each special event has its own interface, and demands some properties be there.
Some properties will replace the getter with RxJava Observables.</p></div></aside></section><section id="slide-snapshots"><h2>Snapshots</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">public class PatientAccount
        implements JavaSnapshot&lt;Long, Patient, Long, Long, PatientEvent&gt;,
        Serializable {
    private Long id;
    private Patient aggregate;
    private Patient deprecatedBy;
    private List&lt;Patient&gt; deprecates = new ArrayList&lt;&gt;();
    private Long lastEventPosition;
    private Date lastEventTimestamp;

    private String name;
    private BigDecimal balance = new BigDecimal(0);
    private BigDecimal moneyMade = new BigDecimal(0);

    public Observable&lt;Patient&gt; getAggregateObservable() {
        return just(aggregate);
    }

    public Observable&lt;Patient&gt; getDeprecatedByObservable() {
        return just(deprecatedBy);
    }

    public Observable&lt;Patient&gt; getDeprecatesObservable() {
        return from(deprecates);
    }
}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>In this case, we&#8217;re looking at a snapshot of a patient that will tell us how much is owed by the patient, and how much money has been made.
Pretty simple: The highlighted portions show us those properties.
The rest is to make Grooves happy.</p></div>
<div class="paragraph"><p><code>deprecatedBy</code> tells you if the aggregate that this snapshot represents has been deprecated by another aggregate.
Think of the Freddie Mercury and Farokh Bulsara example.</p></div>
<div class="paragraph"><p><code>deprecates</code> tells you of all the aggregates that were deprecated by the aggregate of this snapshot.
That helps you look up the deprecated ones to see if you need to include any event in your computation.</p></div>
<div class="paragraph"><p>If you&#8217;re just computing bank balances, it&#8217;s easy.
If you&#8217;re doing something complex like looking at multiple medications and deciding if something needs to be done for a patient, you can&#8217;t take shortcuts.</p></div></aside></section></section>
<section><section id="slide-grooves-queries"><h2>Grooves Queries</h2><aside class="notes"><div class="paragraph"><p>Next up, lets look at what it takes to write a query.
In our mathematical representation, it was a simple function called <code>f</code>.</p></div></aside></section><section id="slide-satisfying-grooves"><h2>Satisfying grooves</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">public class PatientAccountQuery&lt;...&gt; extends QuerySupport&lt;...&gt; {
    ...
}</code></pre></div></div>
<div class="paragraph"><p>Could also be <code>VersionedQuerySupport</code> or <code>TemporalQuerySupport</code></p></div>
<aside class="notes"><div class="paragraph"><p>I&#8217;m assuming for this part that you might do either kind of query, i.e. by timestamp or by position.
The position is only for events. Once it becomes a snapshot, we&#8217;ll call it a version.</p></div>
<div class="paragraph"><p>If you know that you&#8217;ll only do one kind, you could reduce how much code you need to write.</p></div></aside></section><section id="slide-fetching-snapshots"><h2>Fetching snapshots</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">    @Override
    public PatientAccount createEmptySnapshot() {
        return new PatientAccount();
    }

    @Override
    public Observable&lt;PatientAccount&gt; getSnapshot(
            long maxPosition, Patient aggregate) {
        ...
    }

    @Override
    public Observable&lt;PatientAccount&gt; getSnapshot(
            Date maxTimestamp, Patient aggregate) {
        ...
    }</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>First off we&#8217;ll have to get the query to be able to do 3 things</p></div>
<div class="ulist"><ul><li><p>Produce an empty snapshot; this is like a zero balance account in banking, or a patient with no medications or procedures in our case.</p></li><li><p>Find a snapshot that was computed and persisted earlier in the database.</p><div class="ulist"><ul><li><p>This could be done by a max position, i.e. find a snapshot older or equal to the desired version.
That way we can optionally add more events to it.</p></li><li><p>Or it could be done by a max timestamp. Same thing more or less.</p></li></ul></div></li></ul></div></aside></section><section id="slide-fetching-events"><h2>Fetching events</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">    @Override
    public Observable&lt;PatientEvent&gt; getUncomputedEvents(
            Patient aggregate, PatientAccount lastSnapshot, long version) {

    }

    @Override
    public Observable&lt;PatientEvent&gt; getUncomputedEvents(
            Patient aggregate, PatientAccount lastSnapshot, Date snapshotTime) {

    }</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>Next up, we&#8217;ll find events that occur between a previous snapshot, and the desired version or timestamp.
Once we find these events, we can then apply them one after another.</p></div></aside></section><section id="slide-handling-errors"><h2>Handling errors</h2><div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">    @Override
    default Observable&lt;EventApplyOutcome&gt; onException(
            Exception e, PatientAccount snapshot, PatientEvent event) {
        getLog().error("Error computing snapshot", e);
        return just(CONTINUE);
    }</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>Sometimes your code can throw exceptions.
If it does, we need a place to catch these exceptions and decide what to do.
We might just take the simplest path and log the exception and abort the computation for this snapshot.</p></div>
<div class="paragraph"><p>Or, you could collect all the exceptions, and then present them to the user in a simpler form.
This way, you can tell the user that you tried to do your best, but that wasn&#8217;t good enough.</p></div>
<div class="paragraph"><p>So, though you can present them with a snapshot, they should take it with a grain of salt.</p></div>
<div class="paragraph"><p>You might not want to do that for a financial transaction, but if you&#8217;re doing something for health care, this is much better than an error message.
The doctor can look your condition, and the warning, and then ask the patient, "Hey, you&#8217;ve got high blood pressure, but I don&#8217;t see your blood pressure medication. Are you taking one? Let me fix the record here&#8230;&#8203;"</p></div></aside></section><section id="slide-processing-events"><h2>Processing events</h2><div class="paragraph"><p>For languages like Java, Groovy</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">    public Observable&lt;EventApplyOutcome&gt; applyPatientCreated(
            PatientCreated event, PatientAccount snapshot) {
        if (snapshot.getAggregate() == event.getAggregate()) {
            snapshot.setName(event.getName());
        }
        return just(CONTINUE);
    }

    ...</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>So we&#8217;re going to assume your jvm language is very much like java.
This works for groovy too.</p></div>
<div class="paragraph"><p>You can write a method based on the event name that applies the event to a snapshot.
Then it returns the outcome in an observable.</p></div>
<div class="paragraph"><p>This needs to be done only for user events.
Special events will not come here at all, which makes sense.
The reason those events are special is they can be made to work in any domain.
What good is a library if it doesn&#8217;t handle those for you.</p></div>
<div class="paragraph"><p>It&#8217;s a bit of a problem, in that your compiler won&#8217;t tell you if you&#8217;ve covered all event types.</p></div></aside></section><section id="slide-processing-events-2"><h2>Processing events</h2><div class="paragraph"><p>For languages with case classes</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="kotlin language-kotlin">    override fun applyEvent(
        event: PatientEvent.Applicable, snapshot: PatientAccount) =
            when (event) {
                is PatientEvent.Applicable.Created -&gt; {
                    // Your logic here
                    just(CONTINUE)
                }
                is PatientEvent.Applicable.ProcedurePerformed -&gt; {
                    // Your logic here
                    just(CONTINUE)
                }
                is PatientEvent.Applicable.PaymentMade -&gt; {
                    // Your logic here
                    just(CONTINUE)
                }
            }</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>If you&#8217;re using something like kotlin or scala, where you&#8217;ve got case classes or sealed classes, you can do this.
This example is in Kotlin, and uses a when statement as a method expression.</p></div>
<div class="paragraph"><p>Now the compiler will error out if you miss out on some subclass of your events.</p></div></aside></section><section id="slide-events-2"><h2>Events</h2><div class="paragraph"><p>For languages with case classes</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="kotlin language-kotlin">sealed class PatientEvent : BaseEvent&lt;..&gt; {
    // Properties and methods from equivalent java class

    sealed class Applicable : PatientEvent() {
        data class Created(val name: String) : Applicable()
        data class ProcedurePerformed(
                val code: String, val cost: Double) : Applicable()
        ..
    }

    data class Reverted(override val revertedEventId: String) :
            PatientEvent(), RevertEvent&lt;..&gt;
}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>Of course, you need to write your events using sealed classes.
This is great for Kotlin and Scala.
But what about Java and Groovy?</p></div></aside></section><section id="slide-completeness-for-java"><h2>Completeness for Java</h2><div class="paragraph"><p>&#8230;&#8203;and Groovy.</p></div>
<div class="listingblock"><div class="content"><pre class="highlight"><code class="java language-java">@Aggregate public class Patient {...}
public abstract class PatientEvent {}

@Event(Patient.class)
public class ProcedurePerformed extends PatientEvent {}
@Event(Patient.class)
public class PaymentMade extends PatientEvent {}

@Query(aggregate=Patient.class, snapshot=PatientAccount.class)
public class PatientAccountQuery {
    ...
    Observable&lt;EventApplyOutcome&gt; applyProcedurePerformed() {...}
    Observable&lt;EventApplyOutcome&gt; applyPaymentMade() {...}
}</code></pre></div></div>
<aside class="notes"><div class="paragraph"><p>Java as well as groovy allow you to customize compilation a little bit.</p></div>
<div class="paragraph"><p>Java uses Annotation Processors, Groovy uses AST Transformations.</p></div>
<div class="paragraph"><p>With a few annotations, you can verify completeness at compile time.</p></div>
<div class="paragraph"><p>Downsides? IDE support. Custom plugins?</p></div></aside></section></section>
<section><section id="slide-gotchas"><h2>Gotchas</h2><aside class="notes"><div class="paragraph"><p>This is my favorite part of this presentation.</p></div>
<div class="paragraph"><p>Some of these are things I wish I knew before I started exploring this space.</p></div></aside></section><section id="slide-lance-one" data-background-image="http://www.vosizneias.com/wp-content/uploads/2013/01/h_50493197.jpg"><div class="paragraph"><p><span class="highlighted">How many Tour de France General Classification Tour victories did this guy have on 2007-10-01?</span></p></div>
<div class="paragraph highlighted attribution"><p>EPA/JASPER JUINEN, 22 July 2004. Sourced from <a href="http://www.vosizneias.com/wp-content/uploads/2013/01/h_50493197.jpg">vosizneias</a></p></div>
<aside class="notes"><div class="paragraph"><p>Before we go into details, does anyone want to answer the question?</p></div>
<div class="paragraph"><p>I don&#8217;t see anyone in the hall wearing lycra or leaning their bikes against the wall.
So let&#8217;s look at the raw data and see if we can answer the question.</p></div>
<div class="paragraph"><p>How many Tour de France victories did Lance have on this day, 10 years ago?</p></div></aside></section><section id="slide-lance-armstrong"><h2>Lance Armstrong</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%" /><col style="width:66.6667%" /></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1992</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Joins Motorola</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1993</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>DNF</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1994</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>DNF</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1995</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>36</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1996</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>DNF</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1996-10</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Diagnosed with Cancer</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1997-02</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Declared cancer free</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1998</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Joins US Postal</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">1999</p></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="./images/Jersey_yellow.svg.png" alt="Jersey yellow.svg" height="20px" /></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2000</p></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="./images/Jersey_yellow.svg.png" alt="Jersey yellow.svg" height="20px" /></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2001</p></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="./images/Jersey_yellow.svg.png" alt="Jersey yellow.svg" height="20px" /></div></div></td></tr></tbody></table></div></td><td class="tableblock halign-left valign-top"><div><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:33.3333%" /><col style="width:66.6667%" /></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2002</p></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="./images/Jersey_yellow.svg.png" alt="Jersey yellow.svg" height="20px" /></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2003</p></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="./images/Jersey_yellow.svg.png" alt="Jersey yellow.svg" height="20px" /></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2004</p></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="./images/Jersey_yellow.svg.png" alt="Jersey yellow.svg" height="20px" /></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2005</p></td><td class="tableblock halign-left valign-top"><div><div class="imageblock" style=""><img src="./images/Jersey_yellow.svg.png" alt="Jersey yellow.svg" height="20px" /></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2005</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Retires</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2009</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Returns from retirement</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2009</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>3</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2010</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>23</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2010</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Retires</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">2012-10</p></td><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p>Stripped of all wins from 1998 through 2010</p></div></div></td></tr></tbody></table></div></td></tr></tbody></table>
<aside class="notes"><div class="paragraph"><p>The victories are represented by the yellow jersey in the table.</p></div>
<div class="ulist"><ul><li><p>Is the answer 7?</p></li><li><p>Is the answer 0?</p></li><li><p>Is there any other answer?</p></li></ul></div>
<div class="paragraph"><p>Well, the fact that we have more than one answer that seems correct means, that the question is wrong.</p></div>
<div class="paragraph"><p>And what&#8217;s worse is, we&#8217;ve let our users look at the same inputs as our software and now they are convinced our software is broken.</p></div>
<div class="paragraph"><p>So let&#8217;s fix the problem.</p></div></aside></section><section id="slide-lance-two" data-background-image="http://www.vosizneias.com/wp-content/uploads/2013/01/h_50493197.jpg"><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:37.5%" /><col style="width:25%" /><col style="width:37.5%" /></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><div><div class="paragraph"><p><span class="highlighted">1. Based on what we knew in 2007, How many TdF GC Tour victories did he have on 2007-10-01?</span></p></div></div></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-right valign-top"><div><div class="paragraph"><p><span class="highlighted">2. Based on what we know in 2017, How many TdF GC Tour victories did he have on 2007-10-01?</span></p></div></div></td></tr></tbody></table>
<div class="paragraph fragment"><p><span class="highlighted">Ask the right question</span></p></div>
<aside class="notes"><div class="paragraph"><p>There are in fact two different questions.
Now, I hope we have consistent answers.</p></div></aside></section><section id="slide-advice-on-handling-data"><h2>Advice on handling data</h2><div class="ulist"><ul><li><p>Be very careful about what your events look like.</p></li><li><p>Don&#8217;t worry much about what your snapshots look like.</p></li></ul></div>
<aside class="notes"><div class="paragraph"><p>What I learnt was, that we need to be very careful when getting new kinds of data into the system.
Mistakes made there are very hard to correct.</p></div>
<div class="paragraph"><p>Mistakes in processing data are relatively easy to correct.</p></div></aside></section><section id="slide-communication-is-key" class="to-top"><h2>Communication is key</h2><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">95% of the cost of event sourcing projects is explaining event sourcing</p>&mdash; Scott Bellware (@sbellware) <a href="https://twitter.com/sbellware/status/873723025472016384">June 11, 2017</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
<aside class="notes"><div class="paragraph"><p>Having detailed documentation on what your aggregates, events and snapshots are, really helps.</p></div>
<div class="paragraph"><p>In the early days, we used tables and json and what not to communicate what we expected in our aggregates and events.</p></div>
<div class="paragraph"><p>Later on we switched to using diagrams like the ones I used in this presentation.
This reduced the overhead of having to talk to several developers from many teams about what we were doing.
People just began to understand from our diagrams.</p></div></aside></section><section id="slide-non-event-sources-of-data"><h2>Non Event Sources of data</h2><div class="paragraph"><p>When the intent of the user is not clear from the datasource.</p></div>
<aside class="notes"><div class="paragraph"><p>One problem my team faced was data was not always event based.
So some system would always expose their current state as an API or a file export.
And we would have to read that and figure out what to do.</p></div>
<div class="paragraph"><p>Should we break down the entire resource from this source into small atomic events?
Should we treat the whole thing as one giant event?</p></div></aside></section><section id="slide-goldilocks" data-background-image="https://www.fluentin3months.com/wp-content/uploads/2016/01/goldilocks_2.jpg"><div class="paragraph highlighted attribution"><p>The Story of Goldilocks and The Three Bears, Award Publications LTD</p></div>
<aside class="notes"><div class="paragraph"><p>In the end, we decided to do different things for different kinds of sources.
It&#8217;s very hard to find out what&#8217;s <em>just right</em> for a problem.
But it&#8217;s worth the trial and error if you have that luxury to find what&#8217;s best.</p></div></aside></section></section>
<section id="slide-thank-you"><h2>Thank you</h2><table class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:20%" /><col style="width:80%" /></colgroup><tbody><tr><td class="tableblock halign-right valign-top"><p class="tableblock">Slidedeck</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://bit.ly/2017-es">bit.ly/2017-es</a></p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">Grooves</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/rahulsom/grooves">github.com/rahulsom/grooves</a></p></td></tr></tbody></table>
<table id="otherTalks" class="tableblock frame-all grid-all" style="width:100%"><colgroup><col style="width:21.4285%" /><col style="width:14.2857%" /><col style="width:64.2858%" /></colgroup><tbody><tr><td class="tableblock halign-right valign-top"><p class="tableblock">Sun 15:00</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CON7610</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Microservices Data Patterns: CQRS and ES</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">Mon 16:30</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CON2526</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Reactive Stream Processing with Swarm and Kafka</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">Mon 17:30</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CON7474</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">ES, Distributed Systems, and CQRS with Java EE</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">Tue 13:15</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CON4083</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Async by Default, Synchronous When Necessary</p></td></tr><tr><td class="tableblock halign-right valign-top"><p class="tableblock">Wed 14:45</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CON4277</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Three µS Patterns to Tear Down Your Monoliths</p></td></tr></tbody></table>
<aside class="notes"><div class="paragraph"><p>Before I open the floor for the last questions, I would like to thank you all for coming here today.
If you go to those two urls under github, you can find the slides or the library I&#8217;ve created for solving these problems.</p></div>
<div class="paragraph"><p>If you&#8217;re interested in learning more about event sourcing, 2017 is a great year at Java One for Event Sourcing.
There are 5 other talks that have Event Sourcing or CQRS in their abstract.</p></div>
<div class="paragraph"><p>Once again, thank you! And I hope you have a great time at Java One.</p></div></aside></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display controls in the bottom right corner
  controls: true,
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: true,
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  previewLinks: false,
  // Theme (e.g., beige, black, league, night, serif, simple, sky, solarized, white)
  // NOTE setting the theme in the config no longer works in reveal.js 3.x
  //theme: Reveal.getQueryHash().theme || 'custom',
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: Reveal.getQueryHash().transition || 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
  ]
});</script><script src="scripts/prism.js"></script></body></html>